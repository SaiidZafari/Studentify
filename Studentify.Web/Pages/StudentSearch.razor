@page "/Students/Search/{name}"

@using Studentify.Models;
@using Studentify.Web.Services;
@using Microsoft.AspNetCore.Components;
@using System.Collections.Generic;
@using System.Linq;
@using System.Threading.Tasks;


<h3>Student Search</h3>

<hr />
<form action="Students/Search/Tim" method="get">
    <div class="input-group">
        @*<input class="form-control" @bind="@SearchTerm" />*@
        <input class="form-control" @bind-value="@SearchTerm" />

        <div class="input-group-append">

            @if (Students == null)
            {
                <div class="spinner"></div>
                //<h3>Loading</h3>
            }
            else
            {
                if (@SearchTerm != null)
                {
                    <a href="@($"Students/Search/{SearchTerm}")" class="btn btn-primary">Search</a>
                }
                else
                {

                    <a href="@($"/Students")" class="btn btn-primary">Search</a>

                }

            }


        </div>
    </div>
</form>
<hr />



<div class="container-fluid border p-2">
    <div class="row pl-3">
        @if (Students == null)
        {
            <h3>Loading</h3>
        }
        else
        {
            <div class="col-3 border mt-1">
                <h4>Sort by</h4>
                <form>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="sort" value="name" checked />
                        <label class="form-check-label" for="Name">Student Name</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="sort" value="id" />
                        <label class="form-check-label" for="id">Student Id</label>
                    </div>
                </form>
            </div>
            <div class="col-9 pt-1">
                @foreach (var student in Students)
                {
                    <div class="row">
                        <div class="col-3">
                            <img class="d-block w-auto mx-auto" style="max-height:200px" src="@(student.ImageUrl == null? "/images/default.png" : student.ImageUrl)" alt="@student.StudentName" />
                        </div>
                        <div class="col-7">
                            <h4>@student.StudentName</h4>
                            <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Facilis eius qui, non modi sint a.</p>
                        </div>
                        <div class="col-2 d-flex flex-row">
                            <button class="btn btn-secondary align-self-end">Details</button>
                        </div>
                    </div>
                    <hr />
                }
            </div>
        }
    </div>
</div>

@code
{

    [Inject]
    public IStudentService StudentService { get; set; }


    public IEnumerable<Student> Students { get; set; }

    [Parameter]
    public string SearchTerm { get; set; }


    [Parameter]
    public string name { get; set; }


    protected override async Task OnInitializedAsync()
    {
        Students = (await StudentService.Search(name)).ToList();
    }

}